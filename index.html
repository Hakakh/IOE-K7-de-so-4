<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IOE English Master - K7 Đề số 4</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel for JSX transformation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    
    <style>
      body { font-family: 'Nunito', sans-serif; }
      
      /* Custom Scrollbar */
      .custom-scrollbar::-webkit-scrollbar { width: 8px; }
      .custom-scrollbar::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 4px; }
      .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
      .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
      
      /* Animations */
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
      }
      .animate-fade-in { animation: fadeIn 0.4s ease-out forwards; }
      
      @keyframes slideUp {
        from { transform: translateY(20px); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
      }
      .animate-slide-up { animation: slideUp 0.4s ease-out forwards; }

      @keyframes bounceShort {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-5px); }
      }
      .animate-bounce-short { animation: bounceShort 1s infinite; }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "react/": "https://aistudiocdn.com/react@^19.2.0/"
  }
}
</script>
</head>
<body class="bg-slate-100 text-slate-800 antialiased min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // ==========================================
        // 1. TYPES & ENUMS
        // ==========================================
        
        // Defined as objects for better compatibility in standalone script
        const QuestionType = {
            MULTIPLE_CHOICE: 'MULTIPLE_CHOICE',
            FILL_IN_BLANK: 'FILL_IN_BLANK',
            REARRANGE: 'REARRANGE'
        };

        const GameState = {
            START: 'START',
            PLAYING: 'PLAYING',
            FINISHED: 'FINISHED'
        };

        // ==========================================
        // 2. CONSTANTS & DATA
        // ==========================================

        const cleanUrl = (url) => {
            if (!url) return undefined;
            return url.trim()
                .replace(/\s+/g, '')
                .replace(/res\.ioe\.vnzedu/, 'res.ioe.vn/edu')
                .replace(/res\.ioe\.vii/, 'res.ioe.vn')
                .replace(/res\.ioe\.vm/, 'res.ioe.vn')
                .replace(/Audio\s*mp3/i, 'Audio.mp3')
                .replace(/ImageExam\s*(\d)/, 'ImageExam/$1')
                .replace(/Olympic\s*ExamData/, 'OlympicExamData')
                .replace(/EOlympic\s*ExamData/, 'EOlympic/ExamData')
                .replace(/'/g, '')
                .replace(/Audio-mp3/i, 'Audio.mp3');
        };

        const QUIZ_DATA = [
            { id: 1, type: QuestionType.FILL_IN_BLANK, questionText: "Tuan _ _ tall and handsome with a smiling face.", correctAnswer: "is", explanation: "Tuan (chủ ngữ số ít) đi với động từ tobe 'is'." },
            { id: 2, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["some", "There are", "behind", "tall trees", "my house."], correctAnswer: "There are some tall trees behind my house.", explanation: "Có vài cây cao ở sau nhà tôi." },
            { id: 3, type: QuestionType.FILL_IN_BLANK, questionText: "You will _ _ fine after taking these medicines.", correctAnswer: "be", explanation: "Sau 'will' là động từ nguyên mẫu (be)." },
            { id: 4, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["for the", "dictionary?", "Does she", "money", "need some"], correctAnswer: "Does she need some money for the dictionary?", explanation: "Cô ấy có cần tiền để mua từ điển không?" },
            { id: 5, type: QuestionType.FILL_IN_BLANK, questionText: "I’m glad to hear you _ _ _ doing well.", correctAnswer: "are", explanation: "You are doing well (Thì hiện tại tiếp diễn)." },
            { id: 6, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["I will call", "me", "the police if", "alone.", "you don’t leave"], correctAnswer: "I will call the police if you don’t leave me alone.", explanation: "Tôi sẽ gọi cảnh sát nếu bạn không để tôi yên." },
            { id: 7, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["pleased that", "I am", "are well.", "your family", "you and"], correctAnswer: "I am pleased that you and your family are well.", explanation: "Tôi rất vui khi biết bạn và gia đình đều khỏe." },
            { id: 8, type: QuestionType.FILL_IN_BLANK, questionText: "She doesn’t usually come home _ _ _ _ _ 10 o’clock.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2015/1/8/635563332654623107_Audio.mp3"), correctAnswer: "until", explanation: "Until: Cho đến khi." },
            { id: 9, type: QuestionType.FILL_IN_BLANK, questionText: "The secretary took a message _ _ _ her boss.", correctAnswer: "for", explanation: "Message for: Tin nhắn dành cho ai." },
            { id: 10, type: QuestionType.FILL_IN_BLANK, questionText: "Hoang likes playing _ _ _ piano, too.", correctAnswer: "the", explanation: "Play the + nhạc cụ (piano)." },
            { id: 11, type: QuestionType.MULTIPLE_CHOICE, questionText: "Can’t you speak English?", options: ["Yes. I can speak Spanish but I can’t speak English.", "Yes. I can speak English well.", "No. I can speak English well.", "No. I can speak Spanish, too."], correctAnswer: "Yes. I can speak English well.", explanation: "Câu hỏi phủ định 'Can't you...?'. Trả lời 'Yes' nghĩa là 'Có, tôi nói được'." },
            { id: 12, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["last year.", "This book", "for children", "was", "written"], correctAnswer: "This book for children was written last year.", explanation: "Cuốn sách dành cho trẻ em này được viết vào năm ngoái." },
            { id: 13, type: QuestionType.FILL_IN_BLANK, questionText: "Children should spend only a small part of their free time playing electronic _ _ _ _ _ .", correctAnswer: "games", explanation: "Electronic games: Trò chơi điện tử." },
            { id: 14, type: QuestionType.FILL_IN_BLANK, questionText: "What was _ _ _ most common illness?", correctAnswer: "the", explanation: "The most: So sánh nhất." },
            { id: 15, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["does.", "I don’t", "my sister", "hard as", "work as"], correctAnswer: "I don’t work as hard as my sister does.", explanation: "Tôi không làm việc chăm chỉ bằng chị tôi." },
            { id: 16, type: QuestionType.FILL_IN_BLANK, questionText: "He said that he had a lot of free time because I _ _ _ _ _ _ him so much.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2017/3/3/636241439222278003_Audio.mp3"), correctAnswer: "helped", explanation: "Nghe audio: Helped (đã giúp đỡ)." },
            { id: 17, type: QuestionType.FILL_IN_BLANK, questionText: "How many kilos _ _ rice do you need? – 10 kilos, please.", correctAnswer: "of", explanation: "Kilos of rice: Cân gạo." },
            { id: 18, type: QuestionType.MULTIPLE_CHOICE, questionText: "… time do you spend learning English every day?", options: ["How much", "How many", "How long", "How often"], correctAnswer: "How much", explanation: "Time (thời gian) là danh từ không đếm được -> How much." },
            { id: 19, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["to apologize.", "too", "late", "It is", "never"], correctAnswer: "It is never too late to apologize.", explanation: "Không bao giờ là quá muộn để xin lỗi." },
            { id: 20, type: QuestionType.MULTIPLE_CHOICE, questionText: "Which word has different stress pattern?", options: ["uncle", "idea", "dozen", "purple"], correctAnswer: "idea", explanation: "'Idea' nhấn âm 2, các từ còn lại nhấn âm 1." },
            { id: 21, type: QuestionType.FILL_IN_BLANK, questionText: "Many people have stopped smoking _ _ _ _ _ _ _ they are afraid that it may be harmful to their health.", correctAnswer: "because", explanation: "Because: Bởi vì." },
            { id: 22, type: QuestionType.FILL_IN_BLANK, questionText: "Why does the world need more _ _ _ _ and land?", correctAnswer: "food", explanation: "More food and land: Thêm lương thực và đất đai." },
            { id: 23, type: QuestionType.FILL_IN_BLANK, questionText: "We live in an _ _ _ _ _ _ _ _ _ in the city.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2014/3/14/635303884799291950_Audio.mp3"), correctAnswer: "apartment", explanation: "Apartment: Căn hộ." },
            { id: 24, type: QuestionType.MULTIPLE_CHOICE, questionText: "Do they have to wear school uniforms … Monday … Friday?", options: ["on/on", "at/at", "from / to", "to/from"], correctAnswer: "from / to", explanation: "From... to...: Từ thứ này đến thứ kia." },
            { id: 25, type: QuestionType.FILL_IN_BLANK, questionText: "What’s this? - _ _ ’s a desk.", correctAnswer: "It", explanation: "It's a desk." },
            { id: 26, type: QuestionType.FILL_IN_BLANK, questionText: "My grandma is too old. She can’t _ _ _ without her glasses.", correctAnswer: "see", explanation: "See: Nhìn/thấy." },
            { id: 27, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["They", "in the", "to race", "began", "forest."], correctAnswer: "They began to race in the forest.", explanation: "Họ bắt đầu cuộc đua trong rừng." },
            { id: 28, type: QuestionType.MULTIPLE_CHOICE, questionText: "Please tell me ... about your hobbies.", options: ["many", "much", "few", "more"], correctAnswer: "more", explanation: "Tell me more: Kể thêm cho tôi." },
            { id: 29, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["English books", "the shelf", "to", "are on", "the right."], correctAnswer: "English books are on the shelf to the right.", explanation: "Sách tiếng Anh ở trên kệ bên phải." },
            { id: 30, type: QuestionType.FILL_IN_BLANK, questionText: "What’s the weather _ _ _ _ in winter? – It’s very cold.", correctAnswer: "like", explanation: "What's the weather like...?" },
            { id: 31, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["playing", "the piano", "practice", "in the afternoon?", "Do they often"], correctAnswer: "Do they often practice playing the piano in the afternoon?", explanation: "Họ có thường tập chơi piano vào buổi chiều không?" },
            { id: 32, type: QuestionType.MULTIPLE_CHOICE, questionText: "What is her …? – She is Australian.", options: ["language", "nationality", "country", "city"], correctAnswer: "nationality", explanation: "Australian (người Úc) là Quốc tịch (Nationality)." },
            { id: 33, type: QuestionType.MULTIPLE_CHOICE, questionText: "We feel ... when we have a stomachache.", options: ["sneeze", "cough", "painful", "running nose"], correctAnswer: "painful", explanation: "Feel painful: Cảm thấy đau đớn." },
            { id: 34, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["the farm", "often have", "dirt on", "them.", "Vegetables from"], correctAnswer: "Vegetables from the farm often have dirt on them.", explanation: "Rau từ nông trại thường bị dính đất." },
            { id: 35, type: QuestionType.MULTIPLE_CHOICE, questionText: "... to keep fit and stay healthy.", options: ["It important", "It is important", "It does important", "It’s important very"], correctAnswer: "It is important", explanation: "Cấu trúc: It is + adj + to V." },
            { id: 36, type: QuestionType.FILL_IN_BLANK, questionText: "GO_ F", correctAnswer: "L", explanation: "GOLF: Môn gôn." },
            { id: 37, type: QuestionType.MULTIPLE_CHOICE, questionText: "… do they go to church? - Every Sunday afternoon.", options: ["How high", "How many", "How much", "How often"], correctAnswer: "How often", explanation: "Hỏi tần suất -> How often." },
            { id: 38, type: QuestionType.FILL_IN_BLANK, questionText: "Could you _ _ _ _ me where the post office is?", correctAnswer: "tell", explanation: "Tell me where...: Chỉ cho tôi..." },
            { id: 39, type: QuestionType.FILL_IN_BLANK, questionText: "W_ ATEVER", correctAnswer: "H", explanation: "WHATEVER: Bất cứ điều gì." },
            { id: 40, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["you", "some money?", "lend", "Would", "me"], correctAnswer: "Would you lend me some money?", explanation: "Bạn có thể cho tôi vay ít tiền không?" },
            { id: 41, type: QuestionType.FILL_IN_BLANK, questionText: "Thanks a _ _ _ ! – You’re welcome!", correctAnswer: "lot", explanation: "Thanks a lot: Cảm ơn nhiều." },
            { id: 42, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["paddies.", "This was", "saw the", "the second", "time Liz"], correctAnswer: "This was the second time Liz saw the paddies.", explanation: "Đây là lần thứ hai Liz nhìn thấy những cánh đồng lúa." },
            { id: 43, type: QuestionType.FILL_IN_BLANK, questionText: "_ _ _ John and his friends lazy? – No, they work very hard.", correctAnswer: "Are", explanation: "John and his friends (số nhiều) -> Are." },
            { id: 44, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the word that has the underlined part pronounced differently:", options: ["scared", "wanted", "interested", "needed"], correctAnswer: "scared", explanation: "'Scared' đuôi -ed phát âm là /d/, các từ còn lại là /id/." },
            { id: 45, type: QuestionType.MULTIPLE_CHOICE, questionText: "My school is at ….", options: ["30 Hoang Hoa Tham Road", "Hoan Kiem District", "a village far from here", "Nam Dinh Province"], correctAnswer: "30 Hoang Hoa Tham Road", explanation: "At + Địa chỉ cụ thể (số nhà)." },
            { id: 46, type: QuestionType.FILL_IN_BLANK, questionText: "He wants to learn _ _ _ to use the computer.", correctAnswer: "how", explanation: "Learn how to: Học cách." },
            { id: 47, type: QuestionType.MULTIPLE_CHOICE, questionText: "What could man do after the invention of breathing equipment?", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2014/3/12/635302333504175244_Audio.mp3"), options: ["Man could breathe freely underwater", "Man could swim freely undersea", "Man could swim freely underwater", "Man could breathe freely in the swimming pool"], correctAnswer: "Man could breathe freely underwater", explanation: "Nghe audio: Con người có thể thở tự do dưới nước." },
            { id: 48, type: QuestionType.FILL_IN_BLANK, questionText: "They are going to spend their _ _ _ _ _ _ _ _ in Vung Tau.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2015/1/9/635563988331724333_Audio.mp3"), correctAnswer: "holidays", explanation: "Spend holidays: Dành kỳ nghỉ." },
            { id: 49, type: QuestionType.FILL_IN_BLANK, questionText: "Staying at _ _ _ _ would be better than going out tonight.", correctAnswer: "home", explanation: "Stay at home: Ở nhà." },
            { id: 50, type: QuestionType.FILL_IN_BLANK, questionText: "Nam studies very well. He sings beautifully, _ _ _ .", correctAnswer: "too", explanation: "Too: Cũng vậy (cuối câu)." },
            { id: 51, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["from", "the city centre.", "very", "far", "John’s apartment is"], correctAnswer: "John’s apartment is very far from the city centre.", explanation: "Căn hộ của John ở rất xa trung tâm thành phố." },
            { id: 52, type: QuestionType.FILL_IN_BLANK, questionText: "ENTERT_ IN", correctAnswer: "A", explanation: "ENTERTAIN: Giải trí." },
            { id: 53, type: QuestionType.FILL_IN_BLANK, questionText: "How _ _ _ _ did he give you? - He gave me 20 dollars.", correctAnswer: "much", explanation: "How much: Hỏi số lượng tiền." },
            { id: 54, type: QuestionType.MULTIPLE_CHOICE, questionText: "We … everything we can to help you!", options: ["do", "shall do", "would do", "had done"], correctAnswer: "shall do", explanation: "Shall do: Sẽ làm (lời hứa/quyết tâm)." },
            { id: 55, type: QuestionType.MULTIPLE_CHOICE, questionText: "I spoke very slowly … he didn’t understand English very well.", options: ["so that", "because", "due to", "because of"], correctAnswer: "because", explanation: "Because + Mệnh đề." },
            { id: 56, type: QuestionType.FILL_IN_BLANK, questionText: "He can’t _ _ _ _ because of his deafness.", imageUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2014/3/19/635308452264195511_566X320.jpg"), correctAnswer: "hear", explanation: "Deafness (điếc) -> Can't hear (nghe)." },
            { id: 57, type: QuestionType.MULTIPLE_CHOICE, questionText: "What time does his class end? – At ....", options: ["afternoon", "evening", "night", "11 AM"], correctAnswer: "11 AM", explanation: "At + Giờ cụ thể." },
            { id: 58, type: QuestionType.MULTIPLE_CHOICE, questionText: "A pilot is the ....", options: ["driver of an airplane", "driver of a bus", "driver of a coach", "driver of a train"], correctAnswer: "driver of an airplane", explanation: "Pilot: Phi công." },
            { id: 59, type: QuestionType.FILL_IN_BLANK, questionText: "I bought a cup of coffee and some pizzas _ _ _ lunch.", correctAnswer: "for", explanation: "For lunch: Cho bữa trưa." },
            { id: 60, type: QuestionType.MULTIPLE_CHOICE, questionText: "Which word is stressed on the first syllable?", options: ["vacation", "summer", "activity", "pollute"], correctAnswer: "summer", explanation: "'Summer' nhấn âm 1, các từ khác nhấn âm 2." },
            { id: 61, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the word that has the underlined part pronounced differently:", options: ["brother", "mother", "come", "police"], correctAnswer: "police", explanation: "'Police' /ə/, các từ còn lại /ʌ/." },
            { id: 62, type: QuestionType.MULTIPLE_CHOICE, questionText: "Don’t eat too much sugar. Don’t forget to do exercises, ....", options: ["either", "neither", "too", "so"], correctAnswer: "either", explanation: "Either: Cũng không (cuối câu phủ định)." },
            { id: 63, type: QuestionType.MULTIPLE_CHOICE, questionText: "What ... you do the last time you ... a bad toothache?", options: ["do / had", "did / have", "did / had", "do / have"], correctAnswer: "did / had", explanation: "Last time -> Quá khứ đơn (did / had)." },
            { id: 64, type: QuestionType.FILL_IN_BLANK, questionText: "They are _ _ _ ing medical check-up at the moment.", correctAnswer: "hav", explanation: "Having: Đang có (khám sức khỏe)." },
            { id: 65, type: QuestionType.MULTIPLE_CHOICE, questionText: "What does pop music mean?", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2015/3/6/635612599647521852_Audio.mp3"), options: ["Popular music", "Unpopular music", "Poland music", "Popcorn music"], correctAnswer: "Popular music", explanation: "Pop = Popular." },
            { id: 66, type: QuestionType.MULTIPLE_CHOICE, questionText: "He’d like a … of soap.", options: ["bottle", "can", "tube", "bar"], correctAnswer: "bar", explanation: "A bar of soap: Một bánh xà phòng." },
            { id: 67, type: QuestionType.FILL_IN_BLANK, questionText: "_ _ _ _ is the tall building over there? - It’s a new library.", correctAnswer: "What", explanation: "What is...?" },
            { id: 68, type: QuestionType.MULTIPLE_CHOICE, questionText: "Which word has different stress pattern?", options: ["surgery", "normal", "amount", "hygiene"], correctAnswer: "amount", explanation: "'Amount' nhấn âm 2, các từ còn lại nhấn âm 1." },
            { id: 69, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["not", "for", "Drinking wine is", "your health.", "good"], correctAnswer: "Drinking wine is not good for your health.", explanation: "Uống rượu không tốt cho sức khỏe." },
            { id: 70, type: QuestionType.MULTIPLE_CHOICE, questionText: "She had worked … she made herself ill.", options: ["such hard that", "such hardly that", "so hardly that", "so hard that"], correctAnswer: "so hard that", explanation: "So hard that: Chăm chỉ đến nỗi mà." },
            { id: 71, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["morning.", "the news", "listen to", "every", "They don’t"], correctAnswer: "They don’t listen to the news every morning.", explanation: "Họ không nghe tin tức vào mỗi sáng." },
            { id: 72, type: QuestionType.FILL_IN_BLANK, questionText: "My mother is always giving me _ _ _ _ _ _ .", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2017/3/3/636241440753690891_Audio.mp3"), correctAnswer: "advice", explanation: "Giving advice: Cho lời khuyên." },
            { id: 73, type: QuestionType.FILL_IN_BLANK, questionText: "She says that I should eat _ _ _ _ _ _ _ _ _ _ if I want to be strong when I grow up.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2017/3/3/636241440659316555_Audio.mp3"), correctAnswer: "vegetables", explanation: "Eat vegetables: Ăn rau." },
            { id: 74, type: QuestionType.FILL_IN_BLANK, questionText: "_ _ _ _ _ I carry that luggage for you? – Thanks.", correctAnswer: "Shall", explanation: "Shall I...: Tôi có nên... (đề nghị giúp đỡ)." },
            { id: 75, type: QuestionType.MULTIPLE_CHOICE, questionText: "She is lying on the beach ... the sun.", options: ["on", "in", "above", "below"], correctAnswer: "in", explanation: "In the sun (đề bài thiếu đáp án in, chọn gần nhất: under the sun - dưới ánh mặt trời)." },
            { id: 76, type: QuestionType.MULTIPLE_CHOICE, questionText: "A movie theater is also a ....", options: ["cinema", "film", "video", "circus"], correctAnswer: "cinema", explanation: "Movie theater = Cinema (Rạp chiếu phim)." },
            { id: 77, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["play football", "school", "team?", "for our", "Does he"], correctAnswer: "Does he play football for our school team?", explanation: "Anh ấy có chơi bóng cho đội trường chúng tôi không?" },
            { id: 78, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["in his", "free time.", "My father", "listening to music", "enjoys"], correctAnswer: "My father enjoys listening to music in his free time.", explanation: "Bố tôi thích nghe nhạc vào thời gian rảnh." },
            { id: 79, type: QuestionType.MULTIPLE_CHOICE, questionText: "He enjoys sports. It means he ... sports.", options: ["favorite", "likes", "hates", "doesn’t like"], correctAnswer: "likes", explanation: "Enjoys = Likes (Thích)." },
            { id: 80, type: QuestionType.FILL_IN_BLANK, questionText: "I have a bad cold. I keep snee_ _ _ _ .", correctAnswer: "zing", explanation: "Sneezing: Hắt hơi." },
            { id: 81, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["Hana’s class", "were very nice", "to her.", "children in", "The other"], correctAnswer: "The other children in Hana’s class were very nice to her.", explanation: "Những đứa trẻ khác trong lớp Hana rất tốt với cô ấy." },
            { id: 82, type: QuestionType.FILL_IN_BLANK, questionText: "I think it’s going to rain. It’s _ _ _ _ _ _ .", imageUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2014/3/19/635308453641677930_566X320.jpg"), correctAnswer: "cloudy", explanation: "Cloudy: Có mây (sắp mưa)." },
            { id: 83, type: QuestionType.FILL_IN_BLANK, questionText: "_ _ careful when you cross this road!", correctAnswer: "Be", explanation: "Be careful: Cẩn thận." },
            { id: 84, type: QuestionType.MULTIPLE_CHOICE, questionText: "Odd one out:", options: ["heavy", "height", "wide", "tall"], correctAnswer: "height", explanation: "'Height' là danh từ, các từ còn lại là tính từ." },
            { id: 85, type: QuestionType.MULTIPLE_CHOICE, questionText: "Oh, I don’t like pork. - ….", options: ["I don’t like, too", "Either do I", "Neither do I", "So don’t I"], correctAnswer: "Neither do I", explanation: "Đồng tình phủ định: Neither do I." },
            { id: 86, type: QuestionType.FILL_IN_BLANK, questionText: "Let’s put the coffee table in the middle _ _ the room.", correctAnswer: "of", explanation: "In the middle of: Ở giữa." },
            { id: 87, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["gallery with", "beautiful pictures.", "an exciting art", "have been to", "Today I"], correctAnswer: "Today I have been to an exciting art gallery with beautiful pictures.", explanation: "Hôm nay tôi đã đến một triển lãm nghệ thuật thú vị với những bức tranh đẹp." },
            { id: 88, type: QuestionType.FILL_IN_BLANK, questionText: "She walks to school. It means she goes to school on _ _ _ _ .", correctAnswer: "foot", explanation: "On foot: Đi bộ." },
            { id: 89, type: QuestionType.MULTIPLE_CHOICE, questionText: "Which word has different stress pattern?", options: ["vegetable", "intersection", "businessman", "neighborhood"], correctAnswer: "intersection", explanation: "'Intersection' nhấn âm 3, các từ còn lại nhấn âm 1." },
            { id: 90, type: QuestionType.FILL_IN_BLANK, questionText: "An: What’s Tommy going to do? - Tony: He is going to _ _ _ _ _ his teeth.", imageUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/4/10/636589516224923672_566X320.jpg"), correctAnswer: "brush", explanation: "Brush teeth: Đánh răng." },
            { id: 91, type: QuestionType.MULTIPLE_CHOICE, questionText: "Odd one out:", options: ["at present", "at the moment", "now", "yesterday"], correctAnswer: "yesterday", explanation: "'Yesterday' là quá khứ, các từ còn lại là hiện tại tiếp diễn." },
            { id: 92, type: QuestionType.FILL_IN_BLANK, questionText: "She will finish all her homework in less _ _ _ _ 2 hours.", correctAnswer: "than", explanation: "Less than: Ít hơn." },
            { id: 93, type: QuestionType.FILL_IN_BLANK, questionText: "My father is a mechanic. He _ _ _ _ _ for a factory in the suburb.", correctAnswer: "works", explanation: "Works: Làm việc." },
            { id: 94, type: QuestionType.FILL_IN_BLANK, questionText: "She _ _ _ _ _ _ her eyes and felt like a bird in the sky.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2014/11/14/635515764454670408_Audio.mp3"), correctAnswer: "closed", explanation: "Closed her eyes: Nhắm mắt lại." },
            { id: 95, type: QuestionType.MULTIPLE_CHOICE, questionText: "’’…’’ has opposite meaning to ’’…’’. (Context: Heavy / Light)", options: ["Full / thin", "Full / low", "Full / heavy", "Full / weight"], correctAnswer: "Full / thin", explanation: "Câu hỏi gốc có thể bị lỗi, chọn cặp từ trái nghĩa hợp lý nhất: Full (đầy) / Empty (rỗng) hoặc Fat/Thin. Trong các lựa chọn, không có cặp nào hoàn hảo. Dựa trên logic loại trừ: Heavy >< Light." },
            { id: 96, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["to walk", "The elephant", "is the largest", "animal", "on Earth."], correctAnswer: "The elephant is the largest animal to walk on Earth.", explanation: "Voi là loài động vật lớn nhất đi bộ trên Trái Đất." },
            { id: 97, type: QuestionType.MULTIPLE_CHOICE, questionText: "I am sleepy. I … go to bed early.", options: ["must", "have to", "can", "mustn’t"], correctAnswer: "must", explanation: "Must: Nên/Phải (tự cảm thấy cần thiết)." },
            { id: 98, type: QuestionType.FILL_IN_BLANK, questionText: "In rich countries, people spend a lot of money _ _ pet food.", correctAnswer: "on", explanation: "Spend money on: Tiêu tiền vào việc gì." },
            { id: 99, type: QuestionType.FILL_IN_BLANK, questionText: "My sister has a big collection of _ _ _ _ _ .", imageUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2016/2/26/635920805466303896_566X320.jpg"), correctAnswer: "dolls", explanation: "Dolls: Búp bê." },
            { id: 100, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["because he", "Mike didn’t", "go to school", "was sick.", "yesterday"], correctAnswer: "Mike didn’t go to school yesterday because he was sick.", explanation: "Mike không đi học hôm qua vì cậu ấy bị ốm." },
            { id: 101, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["two hours", "each day", "It takes her", "to do", "her homework."], correctAnswer: "It takes her two hours each day to do her homework.", explanation: "Cô ấy mất 2 tiếng mỗi ngày để làm bài tập." },
            { id: 102, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["to", "her friends", "come.", "all", "She is expecting"], correctAnswer: "She is expecting all her friends to come.", explanation: "Cô ấy đang mong chờ tất cả bạn bè đến." },
            { id: 103, type: QuestionType.FILL_IN_BLANK, questionText: "Some people decide that they will lose weight so that they can be _ _ _ _ _ _ _ _ _ .", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2017/3/3/636241439553841132_Audio.mp3"), correctAnswer: "healthier", explanation: "Healthier: Khỏe mạnh hơn." },
            { id: 104, type: QuestionType.MULTIPLE_CHOICE, questionText: "I think I’ll go to see ‘Shrek 2’ tomorrow. - …", options: ["Are you?", "Can you?", "Do you?", "Will you?"], correctAnswer: "Will you?", explanation: "Câu hỏi đuôi/hỏi lại cho thì tương lai đơn (Will)." },
            { id: 105, type: QuestionType.MULTIPLE_CHOICE, questionText: "Listen and tick:", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2014/3/12/635302360873643316_Audio.mp3"), options: ["There were many sharks, dolphins and turtles.", "There weren’t many sharks, dolphins and turtles.", "There were some sharks, dolphins and turtles.", "There were sometimes many sharks, dolphins and turtles."], correctAnswer: "There weren’t many sharks, dolphins and turtles.", explanation: "Nghe audio: Không có nhiều..." },
            { id: 106, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["to get used", "with", "It’s difficult", "chopsticks.", "to eating"], correctAnswer: "It’s difficult to get used to eating with chopsticks.", explanation: "Thật khó để làm quen với việc ăn bằng đũa." },
            { id: 107, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the word which has different stress pattern:", options: ["unhappy", "comfortable", "expensive", "material"], correctAnswer: "comfortable", explanation: "'Comfortable' nhấn âm 1, các từ còn lại nhấn âm 2." },
            { id: 108, type: QuestionType.FILL_IN_BLANK, questionText: "Both Mike and his father were very _ _ _ _ _ _ _ when they read about the coming events.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2015/3/6/635612563380442436_Audio.mp3"), correctAnswer: "excited", explanation: "Excited: Hào hứng." },
            { id: 109, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["cucumber", "favorite", "vegetables.", "Spinach and", "are my"], correctAnswer: "Spinach and cucumber are my favorite vegetables.", explanation: "Rau bina và dưa chuột là những loại rau yêu thích của tôi." },
            { id: 110, type: QuestionType.MULTIPLE_CHOICE, questionText: "Do you know what she … at the moment?", options: ["does", "doing", "doing is", "is doing"], correctAnswer: "is doing", explanation: "At the moment -> Hiện tại tiếp diễn (is doing)." },
            { id: 111, type: QuestionType.MULTIPLE_CHOICE, questionText: "John enjoys … tennis.", options: ["playing", "play", "played", "to play"], correctAnswer: "playing", explanation: "Enjoy + V-ing." },
            { id: 112, type: QuestionType.MULTIPLE_CHOICE, questionText: "It’s difficult to cross this street because there is too much … .", options: ["crowd", "traffic", "people", "transport"], correctAnswer: "traffic", explanation: "Too much traffic: Quá nhiều xe cộ." },
            { id: 113, type: QuestionType.FILL_IN_BLANK, questionText: "The earth goes _ _ _ _ _ _ the sun.", correctAnswer: "around", explanation: "Goes around: Quay quanh." },
            { id: 114, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["did", "subjects", "yesterday?", "Which", "you have"], correctAnswer: "Which subjects did you have yesterday?", explanation: "Hôm qua bạn có những môn học nào?" },
            { id: 115, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["the Browns", "often go for", "Where do", "their summer", "vacation?"], correctAnswer: "Where do the Browns often go for their summer vacation?", explanation: "Gia đình Brown thường đi đâu vào kỳ nghỉ hè." },
            { id: 116, type: QuestionType.MULTIPLE_CHOICE, questionText: "… straight across the road.", options: ["Don’t run", "Not run", "No run", "Can’t run"], correctAnswer: "Don’t run", explanation: "Câu mệnh lệnh phủ định: Don't + V." },
            { id: 117, type: QuestionType.FILL_IN_BLANK, questionText: "_ _ _ _ _ did you go last night? – Oh, I went to the cinema.", correctAnswer: "Where", explanation: "Where did you go: Bạn đã đi đâu." },
            { id: 118, type: QuestionType.MULTIPLE_CHOICE, questionText: "She is trying to … her work before the coming exam.", options: ["rehearsal", "review", "practice", "study"], correctAnswer: "review", explanation: "Review work: Ôn tập bài vở." },
            { id: 119, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["tales when we", "were young.", "told us fairy", "often", "My grandmother"], correctAnswer: "My grandmother often told us fairy tales when we were young.", explanation: "Bà tôi thường kể chuyện cổ tích khi chúng tôi còn nhỏ." },
            { id: 120, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the word that has the underlined part pronounced differently from the others:", options: ["town", "flow", "now", "cow"], correctAnswer: "flow", explanation: "'Flow' /əʊ/, các từ còn lại /aʊ/." },
            { id: 121, type: QuestionType.FILL_IN_BLANK, questionText: "He never gets _ _ _ good marks because he is too lazy.", correctAnswer: "any", explanation: "Never (phủ định) -> any." },
            { id: 122, type: QuestionType.MULTIPLE_CHOICE, questionText: "He isn’t happy because he has ... friends in Rome.", options: ["much", "any", "few", "little"], correctAnswer: "few", explanation: "Few: Rất ít (không đủ, mang nghĩa tiêu cực) dùng cho danh từ đếm được." },
            { id: 123, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["three", "the first", "has answered", "questions.", "Each student"], correctAnswer: "Each student has answered the first three questions.", explanation: "Mỗi học sinh đã trả lời 3 câu hỏi đầu tiên." },
            { id: 124, type: QuestionType.FILL_IN_BLANK, questionText: "I always try to avoid _ _ _ _ _ _ _ _ _ money from my friends.", correctAnswer: "borrowing", explanation: "Avoid borrowing: Tránh vay mượn." },
            { id: 125, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the word that has the underlined part pronounced differently:", options: ["fall", "pastime", "badminton", "camp"], correctAnswer: "fall", explanation: "'Fall' /ɔː/, các từ còn lại /æ/ hoặc /ɑː/." },
            { id: 126, type: QuestionType.MULTIPLE_CHOICE, questionText: "Her parents are pleased ... she often gets good marks.", options: ["why", "though", "because", "which"], correctAnswer: "because", explanation: "Because: Bởi vì." },
            { id: 127, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["the aquarium.", "There are", "many different", "fish in", "types of"], correctAnswer: "There are many different types of fish in the aquarium.", explanation: "Có rất nhiều loại cá khác nhau trong bể cá." },
            { id: 128, type: QuestionType.MULTIPLE_CHOICE, questionText: "Who are you going out ...? – Jamie and Sam.", options: ["to", "with", "at", "from"], correctAnswer: "with", explanation: "Go out with: Đi chơi cùng ai." },
            { id: 129, type: QuestionType.FILL_IN_BLANK, questionText: "As we were _ _ _ _ _ _ _ _ the street, we saw an accident.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2015/1/9/635563935835834218_Audio.mp3"), correctAnswer: "crossing", explanation: "Crossing the street: Băng qua đường." },
            { id: 130, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["an ideal place", "for us", "to go swimming", "and fishing.", "The lake is"], correctAnswer: "The lake is an ideal place for us to go swimming and fishing.", explanation: "Hồ là một nơi lý tưởng để chúng tôi đi bơi và câu cá." },
            { id: 131, type: QuestionType.MULTIPLE_CHOICE, questionText: "How much ... do you want, Mom?", options: ["apples", "fish", "pears", "eggs"], correctAnswer: "fish", explanation: "Fish (thịt cá) không đếm được -> How much." },
            { id: 132, type: QuestionType.MULTIPLE_CHOICE, questionText: "We bought ... as souvenirs for our parents.", options: ["all kinds of stamp", "all kind of stamp", "all kind of stamps", "all kinds of stamps"], correctAnswer: "all kinds of stamps", explanation: "All kinds of stamps: Đủ loại tem." },
            { id: 133, type: QuestionType.MULTIPLE_CHOICE, questionText: "What’s the … of Mexico City?- 12 million people.", options: ["students", "languages", "populations", "seasons"], correctAnswer: "populations", explanation: "Population (số ít trong ngữ cảnh này là dân số)." },
            { id: 134, type: QuestionType.FILL_IN_BLANK, questionText: "Why don’t we _ _ camping this weekend?", correctAnswer: "go", explanation: "Go camping." },
            { id: 135, type: QuestionType.FILL_IN_BLANK, questionText: "Farmers are very hard-working. They work from morning _ _ _ _ night on their farms.", correctAnswer: "till", explanation: "From morning till night: Từ sáng tới tối." },
            { id: 136, type: QuestionType.MULTIPLE_CHOICE, questionText: "Susie is so …. She is always breaking things.", options: ["careful", "carefully", "careless", "not careful"], correctAnswer: "careless", explanation: "Careless: Bất cẩn." },
            { id: 137, type: QuestionType.MULTIPLE_CHOICE, questionText: "He was only thirteen, but he ate … his father did.", options: ["as much as", "more that", "much than", "as much than"], correctAnswer: "as much as", explanation: "As much as: Nhiều bằng." },
            { id: 138, type: QuestionType.MULTIPLE_CHOICE, questionText: "Listen and tick:", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2014/3/12/635302355911898601_Audio.mp3"), options: ["Her birthday is on the third of May.", "Her birthday is on the fifth of July.", "Her birthday is on the fifth of March.", "Her birthday is on the fifth of May."], correctAnswer: "Her birthday is on the fifth of May.", explanation: "Nghe audio: Ngày 5 tháng 5." },
            { id: 139, type: QuestionType.FILL_IN_BLANK, questionText: "It is not fair to _ _ _ _ _ _ _ someone just because they don’t look like you want them to look.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2017/3/3/636241438408526435_Audio.mp3"), correctAnswer: "judge", explanation: "Judge: Phán xét." },
            { id: 140, type: QuestionType.FILL_IN_BLANK, questionText: "The new born baby doesn’t have any _ _ _ _ _ at all.", imageUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2015/3/5/635611905475609441_566X320.jpg"), correctAnswer: "teeth", explanation: "Teeth: Răng." },
            { id: 141, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["enough", "The shirt is not", "big", "to wear.", "for her son"], correctAnswer: "The shirt is not big enough for her son to wear.", explanation: "Cái áo không đủ rộng để con trai cô ấy mặc." },
            { id: 142, type: QuestionType.FILL_IN_BLANK, questionText: "Do you live near your parents? – No, I live _ _ _ from them.", correctAnswer: "far", explanation: "Far from: Xa." },
            { id: 143, type: QuestionType.FILL_IN_BLANK, questionText: "The past form of “have” is “_ _ _ ”.", correctAnswer: "had", explanation: "Had: Quá khứ của Have." },
            { id: 144, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["the morning?", "first", "you do", "in", "What do"], correctAnswer: "What do you do first in the morning?", explanation: "Bạn làm gì đầu tiên vào buổi sáng?" },
            { id: 145, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["Let", "you", "lift the box.", "help", "me"], correctAnswer: "Let me help you lift the box.", explanation: "Để tôi giúp bạn nâng cái hộp." },
            { id: 146, type: QuestionType.FILL_IN_BLANK, questionText: "Thanks for the present! – Do you like _ _ ?", correctAnswer: "it", explanation: "Like it: Thích nó." },
            { id: 147, type: QuestionType.MULTIPLE_CHOICE, questionText: "They ... me this dress when they visited the town.", options: ["buy", "will buy", "bought", "are buying"], correctAnswer: "bought", explanation: "Visited (quá khứ) -> Bought." },
            { id: 148, type: QuestionType.FILL_IN_BLANK, questionText: "These shops have goods _ _ _ sale at attractive price.", correctAnswer: "on", explanation: "On sale: Đang giảm giá/bán." },
            { id: 149, type: QuestionType.FILL_IN_BLANK, questionText: "A lot of work is being done _ _ students.", correctAnswer: "by", explanation: "Done by: Được làm bởi (câu bị động)." },
            { id: 150, type: QuestionType.FILL_IN_BLANK, questionText: "This is the second time I ir_ _ _ _ the clothes for myself.", correctAnswer: "oned", explanation: "Ironed: Đã ủi (quần áo)." },
            { id: 151, type: QuestionType.FILL_IN_BLANK, questionText: "It’s very dark here. Turn on the light, _ _ _ _ _ _ .", correctAnswer: "please", explanation: "Please: Làm ơn." },
            { id: 152, type: QuestionType.FILL_IN_BLANK, questionText: "I sometimes _ _ _ _ _ _ _ what it would be like if I could fly like a bird.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2019/2/23/636865180927984727_Audio.mp3"), correctAnswer: "wonder", explanation: "Wonder: Tự hỏi." },
            { id: 153, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["at break time.", "friends is", "Talking with", "way of relaxing", "the most common"], correctAnswer: "Talking with friends is the most common way of relaxing at break time.", explanation: "Nói chuyện với bạn bè là cách thư giãn phổ biến nhất vào giờ giải lao." },
            { id: 154, type: QuestionType.FILL_IN_BLANK, questionText: "There is no n_ _ _ to explain how that machine works. I have got the instruction book now.", correctAnswer: "eed", explanation: "No need: Không cần." },
            { id: 155, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["Taylor", "last night.", "lovely", "looked", "particularly"], correctAnswer: "Taylor looked particularly lovely last night.", explanation: "Taylor trông đặc biệt đáng yêu tối qua." },
            { id: 156, type: QuestionType.FILL_IN_BLANK, questionText: "Mrs. Lien said you could reach her _ _ 8. 545 646.", correctAnswer: "at", explanation: "Reach her at + số điện thoại." },
            { id: 157, type: QuestionType.FILL_IN_BLANK, questionText: "Could you _ _ _ _ me where the post office is?", correctAnswer: "tell", explanation: "Tell me: Chỉ cho tôi." },
            { id: 158, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["for a walk.", "I ask her", "She often", "says no when", "to go out"], correctAnswer: "She often says no when I ask her to go out for a walk.", explanation: "Cô ấy thường từ chối khi tôi rủ đi dạo." },
            { id: 159, type: QuestionType.FILL_IN_BLANK, questionText: "I learn how to play _ _ _ _ _ r at the school club.", imageUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2015/3/4/635610763786096102_566X320.jpg"), correctAnswer: "guita", explanation: "guitar: đàn ghi ta." },
            { id: 160, type: QuestionType.MULTIPLE_CHOICE, questionText: "There is … yogurt in the fridge.", options: ["a lots of", "few", "a little", "many"], correctAnswer: "a little", explanation: "Yogurt (không đếm được) -> A little." },
            { id: 161, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["in the", "are happy to", "The children", "play outside", "early morning."], correctAnswer: "The children are happy to play outside in the early morning.", explanation: "Lũ trẻ vui vẻ chơi ngoài trời vào sáng sớm." },
            { id: 162, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["The hospital", "is on the", "Street.", "Street and Pine", "corner of the Green"], correctAnswer: "The hospital is on the corner of the Green Street and Pine Street.", explanation: "Bệnh viện nằm ở góc đường Green và Pine." },
            { id: 163, type: QuestionType.MULTIPLE_CHOICE, questionText: "It is six thirty in the evening. Maria ... her homework.", options: ["is doing", "does", "is / do", "will do"], correctAnswer: "is doing", explanation: "Hiện tại tiếp diễn (is doing)." },
            { id: 164, type: QuestionType.MULTIPLE_CHOICE, questionText: "… – That one.", options: ["Which is your house?", "Where is your father?", "Is that your book?", "What is that book?"], correctAnswer: "Which is your house?", explanation: "Which... -> That one (Cái kia)." },
            { id: 165, type: QuestionType.FILL_IN_BLANK, questionText: "Don’t worry about _ _ , Mom. I can take care of myself.", correctAnswer: "me", explanation: "About me: Về con." },
            { id: 166, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["has", "long", "Nam’s new friend", "hair.", "black"], correctAnswer: "Nam’s new friend has long black hair.", explanation: "Bạn mới của Nam có mái tóc đen dài." },
            { id: 167, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["Did she", "how to", "new word?", "pronounce this", "teach you"], correctAnswer: "Did she teach you how to pronounce this new word?", explanation: "Cô ấy có dạy bạn cách phát âm từ mới này không?" },
            { id: 168, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["took part in", "and won the", "the competition", "championship.", "His cousin"], correctAnswer: "His cousin took part in the competition and won the championship.", explanation: "Anh họ cậu ấy đã tham gia cuộc thi và giành chức vô địch." },
            { id: 169, type: QuestionType.FILL_IN_BLANK, questionText: "How _ _ _ _ _ do you read an English magazine? – Every month.", correctAnswer: "often", explanation: "How often: Hỏi tần suất." },
            { id: 170, type: QuestionType.FILL_IN_BLANK, questionText: "How _ _ _ _ are you going to stay here? – Just 2 days.", correctAnswer: "long", explanation: "How long: Bao lâu." },
            { id: 171, type: QuestionType.MULTIPLE_CHOICE, questionText: "Let me ... your sick note!", options: ["to see", "seeing", "see", "saw"], correctAnswer: "see", explanation: "Let + O + V-bare (see)." },
            { id: 172, type: QuestionType.FILL_IN_BLANK, questionText: "You ought to learn how to _ _ _ _ this musical instrument.", correctAnswer: "play", explanation: "Play instrument: Chơi nhạc cụ." },
            { id: 173, type: QuestionType.MULTIPLE_CHOICE, questionText: "Reading books … an important role in developing children’s creativity.", options: ["playing", "play", "plays", "to play"], correctAnswer: "plays", explanation: "Plays a role: Đóng vai trò." },
            { id: 174, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["at her sister’s wedding", "wear", "a blue", "dress", "She is going to"], correctAnswer: "She is going to wear a blue dress at her sister’s wedding.", explanation: "Cô ấy sẽ mặc một chiếc váy xanh tại đám cưới chị gái." },
            { id: 175, type: QuestionType.MULTIPLE_CHOICE, questionText: "...! It’s late.", options: ["Going home now", "Go home now", "Going house now", "Go house now"], correctAnswer: "Go home now", explanation: "Mệnh lệnh: Go home now." },
            { id: 176, type: QuestionType.MULTIPLE_CHOICE, questionText: "Where does Jane usually work? - ....", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2014/3/12/635302350408676935_Audio.mp3"), options: ["in England", "in Holland", "in Poland", "in Ireland"], correctAnswer: "in England", explanation: "Nghe audio: England." },
            { id: 177, type: QuestionType.FILL_IN_BLANK, questionText: "Every boys and girls j_ _ _ _ the activity enthusiastically.", correctAnswer: "oined", explanation: "Joined: Đã tham gia." },
            { id: 178, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["to school?", "your sister", "ride bike", "Why", "doesn’t"], correctAnswer: "Why doesn’t your sister ride bike to school?", explanation: "Tại sao chị bạn không đi xe đạp đến trường?" },
            { id: 179, type: QuestionType.FILL_IN_BLANK, questionText: "Money doesn’t buy _ _ _ _ _ _ _ _ _ .", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2017/3/3/636241442503847148_Audio.mp3"), correctAnswer: "happiness", explanation: "Happiness: Hạnh phúc." },
            { id: 180, type: QuestionType.FILL_IN_BLANK, questionText: "I need a new _ _ _ _ _ _ _ tor. Mine is broken for weeks.", imageUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2015/3/4/635610771087376926_566X320.jpg"), correctAnswer: "refrigera", explanation: "Refrigerator: Tủ lạnh." },
            { id: 181, type: QuestionType.MULTIPLE_CHOICE, questionText: "What do a lot of students do in the holiday? - ....", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2014/3/12/635302346300565720_Audio.mp3"), options: ["Study", "Work", "Stay at home", "Have a trip"], correctAnswer: "Have a trip", explanation: "Nghe audio: Đi du lịch." },
            { id: 182, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the word that has the underlined part pronounced differently:", options: ["stomach", "orchestra", "catch", "school"], correctAnswer: "catch", explanation: "'Catch' /tʃ/, các từ còn lại /k/." },
            { id: 183, type: QuestionType.FILL_IN_BLANK, questionText: "Every night I like to _ _ _ _ the internet for about an hour to find interesting information on the web!", correctAnswer: "surf", explanation: "Surf the internet: Lướt web." },
            { id: 184, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["Clara", "all her works.", "the office after", "leaves", "finishing"], correctAnswer: "Clara leaves the office after finishing all her works.", explanation: "Clara rời văn phòng sau khi hoàn thành mọi công việc." },
            { id: 185, type: QuestionType.MULTIPLE_CHOICE, questionText: "I’m sick. – ... well soon.", options: ["Take", "Have", "Get", "Be"], correctAnswer: "Get", explanation: "Get well soon: Sớm bình phục." },
            { id: 186, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["from Ho Chi Minh to", "does it take", "How long", "by plane?", "Noi Bai"], correctAnswer: "How long does it take from Ho Chi Minh to Noi Bai by plane?", explanation: "Bay từ Hồ Chí Minh ra Nội Bài mất bao lâu?" },
            { id: 187, type: QuestionType.MULTIPLE_CHOICE, questionText: "When is the beach busy? - ....", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2014/3/13/635303162239250840_Audio.mp3"), options: ["From June to July", "From July to August", "From June to August", "From June to September"], correctAnswer: "From June to August", explanation: "Nghe audio: Từ tháng 6 đến tháng 8." },
            { id: 188, type: QuestionType.FILL_IN_BLANK, questionText: "The days are short and the _ _ _ _ _ _ are long in winter.", correctAnswer: "nights", explanation: "Nights: Đêm." },
            { id: 189, type: QuestionType.MULTIPLE_CHOICE, questionText: "She is often absent from school because of illness. It means she is ....", options: ["strong", "unhealthy", "fit", "moderate"], correctAnswer: "unhealthy", explanation: "Illness -> Unhealthy (Không khỏe)." },
            { id: 190, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["Mrs. Lan", "her", "called", "newspaper delivery.", "about"], correctAnswer: "Mrs. Lan called her about newspaper delivery.", explanation: "Bà Lan đã gọi cho cô ấy về việc giao báo." },
            { id: 191, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["meat.", "much", "You shouldn’t", "eat", "too"], correctAnswer: "You shouldn’t eat too much meat.", explanation: "Bạn không nên ăn quá nhiều thịt." },
            { id: 192, type: QuestionType.FILL_IN_BLANK, questionText: "It’s a quarter _ _ one.", correctAnswer: "to", explanation: "A quarter to/past." },
            { id: 193, type: QuestionType.MULTIPLE_CHOICE, questionText: "Is this your car? – No, it’s ....", options: ["of Mr. Brown", "to Mr. Brown", "Mr. Brown’s", "Mr. Brown"], correctAnswer: "Mr. Brown’s", explanation: "Sở hữu cách: Mr. Brown's." },
            { id: 194, type: QuestionType.FILL_IN_BLANK, questionText: "CA_ CH", correctAnswer: "T", explanation: "CATCH: Bắt lấy." },
            { id: 195, type: QuestionType.FILL_IN_BLANK, questionText: "It rained a _ _ _ in Chicago last week.", correctAnswer: "lot", explanation: "A lot: Nhiều." },
            { id: 196, type: QuestionType.FILL_IN_BLANK, questionText: "These symptoms will di_ _ _ _ ear after you take these pills", correctAnswer: "sapp", explanation: "Disappear: Biến mất." },
            { id: 197, type: QuestionType.FILL_IN_BLANK, questionText: "I loathe the sound of the d_ _ _ _ . It is so loud.", imageUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2015/3/4/635610772527571456_566X320.jpg"), correctAnswer: "rill", explanation: "Drill: Máy khoan." },
            { id: 198, type: QuestionType.FILL_IN_BLANK, questionText: "Many people have stopped smoking _ _ _ _ _ _ _ they are afraid that it may be harmful to their health.", correctAnswer: "because", explanation: "Because: Bởi vì." },
            { id: 199, type: QuestionType.MULTIPLE_CHOICE, questionText: "The heavy rain prevented me … going camping.", options: ["in", "about", "from", "with"], correctAnswer: "from", explanation: "Prevent from: Ngăn cản khỏi việc gì." },
            { id: 200, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["be?", "will", "what", "I", "Mom,"], correctAnswer: "Mom, what will I be?", explanation: "Mẹ ơi, con sẽ trở thành gì?" }
        ];

        // ==========================================
        // 3. COMPONENTS
        // ==========================================

        // --- AudioPlayer ---
        const AudioPlayer = ({ src }) => {
            const audioRef = useRef(null);
            const [isPlaying, setIsPlaying] = useState(false);

            useEffect(() => {
                setIsPlaying(false);
                if (audioRef.current) {
                    audioRef.current.load();
                }
            }, [src]);

            const togglePlay = () => {
                if (audioRef.current) {
                if (isPlaying) {
                    audioRef.current.pause();
                } else {
                    audioRef.current.play();
                }
                setIsPlaying(!isPlaying);
                }
            };

            return (
                <div className="flex items-center space-x-2 mt-4 mb-2 bg-blue-50 p-2 rounded-lg border border-blue-100 w-fit">
                <button
                    onClick={togglePlay}
                    className={`w-10 h-10 flex items-center justify-center rounded-full transition-colors ${
                    isPlaying ? 'bg-red-500 hover:bg-red-600' : 'bg-blue-500 hover:bg-blue-600'
                    } text-white shadow-sm`}
                    aria-label={isPlaying ? "Pause audio" : "Play audio"}
                >
                    {isPlaying ? (
                    <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                        <path fillRule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z" clipRule="evenodd" />
                    </svg>
                    ) : (
                    <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                        <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clipRule="evenodd" />
                    </svg>
                    )}
                </button>
                <span className="text-sm text-blue-800 font-medium">Listen to the question</span>
                <audio
                    ref={audioRef}
                    src={src}
                    onEnded={() => setIsPlaying(false)}
                    className="hidden"
                />
                </div>
            );
        };

        // --- QuestionCard ---
        const QuestionCard = ({
            question,
            onAnswerSubmit,
            showFeedback,
            userAnswer
        }) => {
            const [inputValue, setInputValue] = useState('');
            const [rearrangeOrder, setRearrangeOrder] = useState([]);
            const [availableParts, setAvailableParts] = useState([]);
            const [isHintVisible, setIsHintVisible] = useState(false);

            useEffect(() => {
                setInputValue('');
                setIsHintVisible(false);
                
                if (question.type === QuestionType.REARRANGE && question.rearrangeParts) {
                    setRearrangeOrder([]);
                    setAvailableParts([...question.rearrangeParts]); 
                }

                if (userAnswer) {
                    if (question.type !== QuestionType.REARRANGE) {
                        setInputValue(userAnswer);
                    }
                }
            }, [question, userAnswer, showFeedback]);

            const handleSubmit = () => {
                if (showFeedback) return;

                let finalAnswer = '';
                if (question.type === QuestionType.MULTIPLE_CHOICE) {
                    finalAnswer = inputValue;
                } else if (question.type === QuestionType.FILL_IN_BLANK) {
                    finalAnswer = inputValue.trim();
                } else if (question.type === QuestionType.REARRANGE) {
                    finalAnswer = rearrangeOrder.join(' ');
                }
                
                if (finalAnswer) {
                    onAnswerSubmit(finalAnswer);
                }
            };

            const handleOptionClick = (option) => {
                if (showFeedback) return;
                setInputValue(option);
                onAnswerSubmit(option);
            };

            const handleRearrangeClick = (word, fromAvailable) => {
                if (showFeedback) return;

                if (fromAvailable) {
                    setAvailableParts(prev => prev.filter(w => w !== word));
                    setRearrangeOrder(prev => [...prev, word]);
                } else {
                    setRearrangeOrder(prev => prev.filter(w => w !== word));
                    setAvailableParts(prev => [...prev, word]);
                }
            };

            const isCorrect = userAnswer?.toLowerCase().trim() === question.correctAnswer.toLowerCase().trim();

            return (
                <div className="bg-white rounded-2xl shadow-xl p-6 md:p-8 max-w-3xl w-full mx-auto animate-fade-in relative overflow-hidden flex flex-col">
                {/* Question Header & Media */}
                <div className="mb-6">
                    <div className="flex justify-between items-start mb-4">
                        <div className="flex gap-2 flex-wrap">
                            <span className="inline-block px-3 py-1 text-xs font-bold tracking-wider text-blue-600 bg-blue-100 rounded-full mb-2">
                                QUESTION {question.id}
                            </span>
                            {!showFeedback && (
                                <button
                                    onClick={() => setIsHintVisible(!isHintVisible)}
                                    className={`inline-flex items-center px-3 py-1 text-xs font-bold tracking-wider rounded-full mb-2 transition-colors ${
                                        isHintVisible 
                                        ? 'bg-yellow-200 text-yellow-800' 
                                        : 'bg-yellow-100 text-yellow-700 hover:bg-yellow-200'
                                    }`}
                                >
                                    <svg className="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20"><path d="M11 3a1 1 0 10-2 0v1a1 1 0 102 0V3zM15.657 5.757a1 1 0 00-1.414-1.414l-.707.707a1 1 0 001.414 1.414l.707-.707zM18 10a1 1 0 01-1 1h-1a1 1 0 110-2h1a1 1 0 011 1zM5.05 6.464A1 1 0 106.464 5.05l-.707-.707a1 1 0 00-1.414 1.414l.707.707zM5 10a1 1 0 01-1 1H3a1 1 0 110-2h1a1 1 0 011 1zM8 16v-1h4v1a2 2 0 11-4 0zM12 14c.015-.34.208-.646.477-.859a4 4 0 10-4.954 0c.27.213.462.519.476.859h4.002z" /></svg>
                                    {isHintVisible ? 'Hide Hint' : 'Show Hint'}
                                </button>
                            )}
                        </div>
                        {question.type === QuestionType.REARRANGE && (
                            <span className="text-xs text-gray-400 font-medium whitespace-nowrap ml-2">Tap words to arrange</span>
                        )}
                    </div>
                    
                    {/* Hint Box */}
                    {isHintVisible && !showFeedback && (
                        <div className="mb-6 bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-r-lg animate-fade-in">
                            <p className="text-sm text-yellow-800 font-bold mb-1 flex items-center">
                                <svg className="w-4 h-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                                Gợi ý (Hint):
                            </p>
                            <p className="text-sm text-yellow-900 italic leading-relaxed">
                                {question.explanation}
                            </p>
                        </div>
                    )}
                    
                    <h2 className="text-xl md:text-2xl font-bold text-gray-800 mb-6 leading-relaxed">
                    {question.questionText}
                    </h2>
                    
                    {question.imageUrl && (
                    <div className="mb-6 rounded-xl overflow-hidden border border-gray-100 shadow-sm bg-gray-50 flex justify-center p-2">
                        <img 
                        src={question.imageUrl} 
                        alt={`Illustration for question ${question.id}`} 
                        className="max-w-full h-auto max-h-[300px] object-contain rounded-lg"
                        loading="lazy"
                        />
                    </div>
                    )}
                    
                    {question.audioUrl && (
                    <div className="flex justify-center mb-6">
                        <AudioPlayer src={question.audioUrl} />
                    </div>
                    )}
                </div>

                {/* Input Area */}
                <div className="mb-8 flex-grow">
                    {question.type === QuestionType.MULTIPLE_CHOICE && question.options && (
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                        {question.options.map((option, idx) => {
                        let btnClass = "w-full text-left p-4 rounded-xl border-2 transition-all duration-200 flex items-center shadow-sm ";
                        if (showFeedback) {
                            if (option === question.correctAnswer) {
                                btnClass += "border-green-500 bg-green-50 text-green-800 font-bold shadow-green-100";
                            } else if (option === userAnswer && option !== question.correctAnswer) {
                                btnClass += "border-red-500 bg-red-50 text-red-800 opacity-80 shadow-red-100";
                            } else {
                                btnClass += "border-gray-100 text-gray-400 opacity-50 bg-gray-50";
                            }
                        } else {
                            btnClass += "border-gray-200 hover:border-blue-400 hover:bg-blue-50 text-gray-700 bg-white hover:shadow-md";
                        }

                        return (
                            <button
                                key={idx}
                                onClick={() => handleOptionClick(option)}
                                disabled={showFeedback}
                                className={btnClass}
                            >
                                <div className={`w-8 h-8 rounded-full border-2 mr-3 flex-shrink-0 flex items-center justify-center font-bold text-sm ${
                                    showFeedback && option === question.correctAnswer ? 'border-green-500 bg-green-500 text-white' : 
                                    showFeedback && option === userAnswer ? 'border-red-500 bg-red-500 text-white' :
                                    'border-gray-300 text-gray-500'
                                }`}>
                                    {['A', 'B', 'C', 'D'][idx]}
                                </div>
                                <span className="flex-grow">{option}</span>
                            </button>
                        );
                        })}
                    </div>
                    )}

                    {question.type === QuestionType.FILL_IN_BLANK && (
                        <div className="relative max-w-lg mx-auto">
                            <input
                                type="text"
                                value={inputValue}
                                onChange={(e) => setInputValue(e.target.value)}
                                onKeyDown={(e) => e.key === 'Enter' && handleSubmit()}
                                disabled={showFeedback}
                                placeholder="Type your answer..."
                                className={`w-full p-4 pl-6 text-lg border-2 rounded-xl focus:outline-none transition-all shadow-sm ${
                                    showFeedback 
                                    ? isCorrect 
                                        ? 'border-green-500 bg-green-50 text-green-800 font-bold' 
                                        : 'border-red-500 bg-red-50 text-red-800 font-bold'
                                    : 'border-gray-200 focus:border-blue-500 text-gray-800 focus:shadow-md'
                                }`}
                            />
                            {!showFeedback && (
                                <button 
                                    onClick={handleSubmit}
                                    disabled={!inputValue.trim()}
                                    className="absolute right-2 top-2 bottom-2 bg-blue-600 text-white px-6 rounded-lg font-bold hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all"
                                >
                                    Submit
                                </button>
                            )}
                        </div>
                    )}

                    {question.type === QuestionType.REARRANGE && (
                        <div className="space-y-6">
                            {/* Constructed Answer Area */}
                            <div className={`min-h-[100px] p-5 rounded-xl border-2 flex flex-wrap gap-2 items-center content-start transition-colors ${
                                showFeedback 
                                    ? isCorrect 
                                        ? 'border-green-500 bg-green-50' 
                                        : 'border-red-500 bg-red-50'
                                    : 'border-blue-200 bg-blue-50/50'
                            }`}>
                                {rearrangeOrder.length === 0 && !showFeedback && (
                                    <span className="text-gray-400 w-full text-center py-4 italic">Tap words below to build sentence...</span>
                                )}
                                {rearrangeOrder.map((word, idx) => (
                                    <button
                                        key={`${word}-${idx}`}
                                        onClick={() => handleRearrangeClick(word, false)}
                                        disabled={showFeedback}
                                        className="bg-white border border-blue-200 text-blue-800 px-3 py-2 rounded-lg shadow-sm hover:bg-red-50 hover:border-red-200 hover:text-red-600 transition-colors font-medium animate-fade-in"
                                    >
                                        {word}
                                    </button>
                                ))}
                            </div>

                            {/* Available Words */}
                            {!showFeedback && (
                                <div className="flex flex-wrap gap-2 justify-center p-4 bg-gray-50 rounded-xl border border-gray-100">
                                    {availableParts.map((word, idx) => (
                                        <button
                                            key={`${word}-${idx}`}
                                            onClick={() => handleRearrangeClick(word, true)}
                                            className="bg-white border border-gray-200 text-gray-700 px-4 py-2 rounded-lg shadow-sm hover:border-blue-400 hover:text-blue-600 hover:shadow-md hover:-translate-y-0.5 active:scale-95 transition-all"
                                        >
                                            {word}
                                        </button>
                                    ))}
                                </div>
                            )}
                            
                            {!showFeedback && (
                                <div className="flex justify-center mt-4">
                                    <button 
                                        onClick={handleSubmit}
                                        disabled={rearrangeOrder.length === 0}
                                        className="bg-blue-600 text-white py-3 px-10 rounded-xl font-bold hover:bg-blue-700 shadow-lg disabled:opacity-50 disabled:shadow-none transition-all transform hover:scale-105"
                                    >
                                        Submit Answer
                                    </button>
                                </div>
                            )}
                        </div>
                    )}
                </div>

                {/* Explanation / Feedback */}
                {showFeedback && (
                    <div className={`mt-auto p-5 rounded-xl border-l-4 animate-slide-up shadow-sm ${
                        isCorrect ? 'bg-green-50 border-green-500' : 'bg-red-50 border-red-500'
                    }`}>
                        <div className="flex items-center mb-3">
                            <div className={`p-1.5 rounded-full mr-3 ${isCorrect ? 'bg-green-200 text-green-700' : 'bg-red-200 text-red-700'}`}>
                                {isCorrect ? (
                                    <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={3} d="M5 13l4 4L19 7" /></svg>
                                ) : (
                                    <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={3} d="M6 18L18 6M6 6l12 12" /></svg>
                                )}
                            </div>
                            <h3 className={`text-lg font-bold ${isCorrect ? 'text-green-800' : 'text-red-800'}`}>
                                {isCorrect ? 'Correct!' : 'Incorrect'}
                            </h3>
                        </div>
                        
                        {!isCorrect && (
                            <div className="mb-4 text-red-800 bg-red-100/50 p-3 rounded-lg border border-red-100">
                                <span className="font-bold text-xs uppercase tracking-wide opacity-70 mb-1 block">Correct Answer</span>
                                <p className="font-semibold text-lg">{question.correctAnswer}</p>
                            </div>
                        )}
                        
                        <div className="text-gray-700 pt-2">
                            <span className="font-bold text-xs uppercase tracking-wide text-gray-500 mb-1 block">Explanation</span>
                            <p className="leading-relaxed">{question.explanation}</p>
                        </div>
                    </div>
                )}
                </div>
            );
        };

        // --- StartScreen ---
        const StartScreen = ({ onStart, totalQuestions }) => {
            const [name, setName] = useState('');

            const handleSubmit = () => {
                if (name.trim()) {
                onStart(name.trim());
                }
            };

            return (
                <div className="flex flex-col items-center justify-center min-h-[60vh] p-8 text-center animate-fade-in">
                <div className="bg-white p-10 rounded-3xl shadow-2xl max-w-lg w-full">
                    <div className="w-24 h-24 bg-yellow-400 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg animate-bounce-short">
                    <svg xmlns="http://www.w3.org/2000/svg" className="h-12 w-12 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
                    </svg>
                    </div>
                    
                    <h1 className="text-3xl md:text-4xl font-extrabold text-slate-800 mb-2">
                    IOE English Master
                    </h1>
                    <p className="text-slate-500 text-lg mb-6 font-medium">
                    Grade 7 - Exam #04
                    </p>

                    <div className="text-left bg-slate-50 p-6 rounded-xl border border-slate-100 mb-6">
                    <label htmlFor="playerName" className="block text-sm font-bold text-slate-700 mb-2">
                        Enter your name to start:
                    </label>
                    <input 
                        type="text" 
                        id="playerName"
                        value={name}
                        onChange={(e) => setName(e.target.value)}
                        onKeyDown={(e) => e.key === 'Enter' && handleSubmit()}
                        placeholder="Your Name (e.g. Nguyen Van A)"
                        className="w-full px-4 py-3 rounded-lg border-2 border-slate-200 focus:border-blue-500 focus:ring-4 focus:ring-blue-100 outline-none transition-all font-bold text-slate-800 placeholder-slate-400"
                        autoFocus
                    />
                    </div>

                    <div className="space-y-4 mb-8 text-left text-sm text-slate-600 px-2">
                    <div className="flex items-center">
                        <span className="w-6 h-6 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center mr-3 text-xs font-bold">1</span>
                        <span>Answer <strong>{totalQuestions} questions</strong> (10 points each)</span>
                    </div>
                    <div className="flex items-center">
                        <span className="w-6 h-6 rounded-full bg-green-100 text-green-600 flex items-center justify-center mr-3 text-xs font-bold">2</span>
                        <span>Learn from detailed explanations</span>
                    </div>
                    </div>

                    <button
                    onClick={handleSubmit}
                    disabled={!name.trim()}
                    className="w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-bold py-4 px-8 rounded-xl shadow-lg transform transition hover:scale-[1.02] active:scale-95 text-lg disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none disabled:shadow-none"
                    >
                    Start Exam
                    </button>
                </div>
                </div>
            );
        };

        // --- ResultScreen ---
        const ResultScreen = ({ playerName, score, points, total, results, onRestart, onRetryWrong }) => {
            const percentage = total > 0 ? Math.round((score / total) * 100) : 0;
            const wrongCount = total - score;
            
            let message = "Good effort!";
            let color = "text-blue-600";
            
            if (percentage >= 90) {
                message = "Outstanding!";
                color = "text-yellow-400";
            } else if (percentage >= 70) {
                message = "Great Job!";
                color = "text-green-400";
            } else if (percentage < 50) {
                message = "Keep Practicing!";
                color = "text-slate-300";
            }

            return (
                <div className="flex flex-col items-center justify-center p-4 animate-fade-in max-w-2xl mx-auto w-full mb-10">
                <div className="bg-white rounded-3xl shadow-2xl w-full overflow-hidden">
                    <div className="bg-slate-900 p-8 text-center text-white relative overflow-hidden">
                        {/* Background decoration */}
                        <div className="absolute top-0 left-0 w-full h-full opacity-10 pointer-events-none">
                            <div className="absolute top-[-50%] left-[-50%] w-[200%] h-[200%] bg-gradient-to-tr from-blue-500 to-purple-500 rotate-12"></div>
                        </div>
                        
                        <h2 className="text-2xl md:text-3xl font-bold mb-2 relative z-10">{message} {playerName}!</h2>
                        <div className={`text-6xl font-extrabold mb-2 relative z-10 ${color}`}>
                            {points} <span className="text-2xl font-bold text-white opacity-80">pts</span>
                        </div>
                        <p className="text-slate-300 relative z-10">You answered {score} out of {total} correctly</p>
                    </div>

                    <div className="p-8">
                        <div className="grid grid-cols-2 gap-4 mb-8">
                            <div className="bg-green-50 p-4 rounded-xl border border-green-100 text-center">
                                <span className="block text-2xl font-bold text-green-700">{score}</span>
                                <span className="text-xs font-bold text-green-600 uppercase tracking-wider">Correct</span>
                            </div>
                            <div className="bg-red-50 p-4 rounded-xl border border-red-100 text-center">
                                <span className="block text-2xl font-bold text-red-700">{wrongCount}</span>
                                <span className="text-xs font-bold text-red-600 uppercase tracking-wider">Incorrect</span>
                            </div>
                        </div>

                        <div className="space-y-3 mb-6">
                            <button
                                onClick={onRestart}
                                className="w-full bg-slate-900 hover:bg-slate-800 text-white font-bold py-4 px-8 rounded-xl shadow-lg transition-transform active:scale-95"
                            >
                                Restart Full Exam
                            </button>
                            
                            {wrongCount > 0 && (
                                <button
                                    onClick={onRetryWrong}
                                    className="w-full bg-white border-2 border-red-100 text-red-600 hover:bg-red-50 hover:border-red-200 font-bold py-4 px-8 rounded-xl transition-transform active:scale-95"
                                >
                                    Retry Incorrect Answers ({wrongCount})
                                </button>
                            )}
                        </div>
                        
                        <div className="border-t pt-6">
                            <h3 className="font-bold text-gray-700 mb-4">Question Summary</h3>
                            <div className="space-y-3 max-h-64 overflow-y-auto custom-scrollbar pr-2">
                                {results.map((res, index) => (
                                    <div key={index} className={`flex items-start p-3 rounded-lg text-sm ${res.isCorrect ? 'bg-green-50' : 'bg-red-50'}`}>
                                        <span className={`font-bold mr-3 ${res.isCorrect ? 'text-green-600' : 'text-red-600'}`}>#{index + 1}</span>
                                        <div className="flex-1">
                                            <p className="text-gray-800 mb-1 font-medium truncate">{res.userAnswer || "(No Answer)"}</p>
                                            {!res.isCorrect && (
                                                <div className="mt-1">
                                                    <p className="text-xs text-gray-500 uppercase font-semibold">Correct Answer:</p>
                                                    <p className="text-green-600 font-medium">{res.correctAnswer}</p>
                                                </div>
                                            )}
                                        </div>
                                        <div className="ml-2">
                                            {res.isCorrect ? (
                                                <svg className="w-5 h-5 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" /></svg>
                                            ) : (
                                                <svg className="w-5 h-5 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" /></svg>
                                            )}
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>
                </div>
                </div>
            );
        };

        // --- ProgressBar ---
        const ProgressBar = ({ current, total }) => {
            const progress = Math.min(100, Math.max(0, ((current) / total) * 100));

            return (
                <div className="w-full max-w-3xl mx-auto mb-6 px-4 md:px-0">
                <div className="flex justify-between text-xs font-bold text-slate-500 mb-1 uppercase tracking-wider">
                    <span>Progress</span>
                    <span>{current} / {total}</span>
                </div>
                <div className="h-3 bg-slate-200 rounded-full overflow-hidden">
                    <div 
                        className="h-full bg-blue-500 transition-all duration-500 ease-out rounded-full"
                        style={{ width: `${progress}%` }}
                    ></div>
                </div>
                </div>
            );
        };

        // --- QuestionNavigation ---
        const QuestionNavigation = ({
            questions,
            answers,
            currentIndex,
            onSelectQuestion,
        }) => {
            return (
                <div className="bg-white p-4 rounded-2xl shadow-sm border border-slate-200 mt-6 w-full max-w-3xl">
                <h3 className="text-sm font-bold text-slate-500 uppercase tracking-wider mb-3">
                    Question Map
                </h3>
                <div className="flex flex-wrap gap-2 max-h-40 overflow-y-auto custom-scrollbar">
                    {questions.map((q, idx) => {
                    const result = answers[q.id];
                    let btnClass = "w-8 h-8 md:w-10 md:h-10 text-xs md:text-sm font-bold rounded-lg flex items-center justify-center transition-all ";
                    
                    if (idx === currentIndex) {
                        btnClass += "ring-2 ring-offset-2 ring-blue-500 ";
                    }

                    if (result) {
                        if (result.isCorrect) {
                        btnClass += "bg-green-100 text-green-700 border border-green-200 hover:bg-green-200";
                        } else {
                        btnClass += "bg-red-100 text-red-700 border border-red-200 hover:bg-red-200";
                        }
                    } else {
                        btnClass += "bg-slate-100 text-slate-500 border border-slate-200 hover:bg-blue-50 hover:text-blue-600 hover:border-blue-200";
                    }

                    return (
                        <button
                        key={q.id}
                        onClick={() => onSelectQuestion(idx)}
                        className={btnClass}
                        >
                        {idx + 1}
                        </button>
                    );
                    })}
                </div>
                <div className="flex gap-4 mt-3 text-xs text-slate-500 font-medium">
                    <div className="flex items-center"><span className="w-3 h-3 bg-green-100 border border-green-200 rounded mr-1"></span> Correct</div>
                    <div className="flex items-center"><span className="w-3 h-3 bg-red-100 border border-red-200 rounded mr-1"></span> Incorrect</div>
                    <div className="flex items-center"><span className="w-3 h-3 bg-slate-100 border border-slate-200 rounded mr-1"></span> Unanswered</div>
                </div>
                </div>
            );
        };

        // ==========================================
        // 4. MAIN APP COMPONENT
        // ==========================================

        const App = () => {
            const [gameState, setGameState] = useState(GameState.START);
            const [playerName, setPlayerName] = useState('');
            
            const [activeQuestions, setActiveQuestions] = useState(QUIZ_DATA);
            const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);
            
            const [answers, setAnswers] = useState({});
            const [showFeedback, setShowFeedback] = useState(false);
            
            const currentQuestion = activeQuestions[currentQuestionIndex];
            const totalQuestions = activeQuestions.length;
            const answeredCount = Object.keys(answers).length;
            
            const correctCount = Object.values(answers).filter(a => a.isCorrect).length;
            const currentPoints = correctCount * 10;

            const handleStartGame = (name) => {
                if (typeof name === 'string' && name.trim()) {
                    setPlayerName(name);
                }
                setActiveQuestions(QUIZ_DATA);
                setGameState(GameState.PLAYING);
                setCurrentQuestionIndex(0);
                setAnswers({});
                setShowFeedback(false);
            };

            const handleRestart = () => {
                handleStartGame();
            }

            const handleRetryWrong = () => {
                const wrongQuestionIds = activeQuestions
                    .filter(q => {
                        const ans = answers[q.id];
                        return !ans || !ans.isCorrect;
                    })
                    .map(q => q.id);
                
                const wrongQuestions = QUIZ_DATA.filter(q => wrongQuestionIds.includes(q.id));
                
                if (wrongQuestions.length === 0) {
                    handleStartGame();
                    return;
                }

                setActiveQuestions(wrongQuestions);
                setGameState(GameState.PLAYING);
                setCurrentQuestionIndex(0);
                setAnswers({});
                setShowFeedback(false);
            };

            const handleAnswerSubmit = (answer) => {
                const isCorrect = answer.toLowerCase().trim() === currentQuestion.correctAnswer.toLowerCase().trim();
                
                const result = {
                    questionId: currentQuestion.id,
                    isCorrect,
                    userAnswer: answer,
                    correctAnswer: currentQuestion.correctAnswer
                };

                setAnswers(prev => ({
                    ...prev,
                    [currentQuestion.id]: result
                }));
                
                setShowFeedback(true);
            };

            const jumpToQuestion = (index) => {
                setCurrentQuestionIndex(index);
                const targetQ = activeQuestions[index];
                if (answers[targetQ.id]) {
                    setShowFeedback(true);
                } else {
                    setShowFeedback(false);
                }
            };

            const handleNextQuestion = () => {
                if (currentQuestionIndex < totalQuestions - 1) {
                    jumpToQuestion(currentQuestionIndex + 1);
                } else {
                    if (answeredCount === totalQuestions) {
                        setGameState(GameState.FINISHED);
                    } else {
                        const firstUnanswered = activeQuestions.findIndex(q => !answers[q.id]);
                        if (firstUnanswered !== -1) {
                            jumpToQuestion(firstUnanswered);
                        } else {
                            setGameState(GameState.FINISHED);
                        }
                    }
                }
            };
            
            const handleFinish = () => {
                setGameState(GameState.FINISHED);
            }

            useEffect(() => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }, [currentQuestionIndex, gameState]);

            return (
                <div className="min-h-screen bg-slate-100 font-sans text-slate-800 flex flex-col">
                {/* Header */}
                <header className="bg-white border-b border-slate-200 sticky top-0 z-20 shadow-sm">
                    <div className="max-w-5xl mx-auto px-4 py-3 flex justify-between items-center">
                        <div className="flex items-center space-x-2">
                            <div className="bg-blue-600 text-white p-1.5 rounded-lg shadow-sm">
                                <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
                                </svg>
                            </div>
                            <h1 className="font-bold text-lg hidden sm:block">IOE Master</h1>
                        </div>
                        
                        {gameState === GameState.PLAYING && (
                            <div className="flex items-center gap-4">
                                {playerName && (
                                    <div className="hidden sm:flex items-center text-sm font-bold text-slate-500 bg-slate-50 px-3 py-1.5 rounded-lg border border-slate-200">
                                        <svg className="w-4 h-4 mr-2 opacity-50" fill="currentColor" viewBox="0 0 20 20"><path fillRule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clipRule="evenodd"></path></svg>
                                        {playerName}
                                    </div>
                                )}
                                <div className="bg-blue-50 px-3 py-1.5 rounded-lg border border-blue-100 flex items-center">
                                    <span className="text-xs text-blue-600 font-bold uppercase mr-2">Points</span>
                                    <span className="text-lg font-extrabold text-blue-700">{currentPoints}</span>
                                </div>
                                <button 
                                    onClick={handleFinish}
                                    className="text-xs font-bold text-slate-500 hover:text-red-500 uppercase tracking-wide px-2"
                                >
                                    Finish
                                </button>
                            </div>
                        )}
                    </div>
                </header>

                <main className="flex-grow flex flex-col items-center justify-center p-4 md:p-6 w-full max-w-5xl mx-auto">
                    
                    {gameState === GameState.START && (
                        <StartScreen onStart={handleStartGame} totalQuestions={QUIZ_DATA.length} />
                    )}

                    {gameState === GameState.PLAYING && currentQuestion && (
                        <div className="w-full flex flex-col items-center pb-20 md:pb-0">
                            <ProgressBar current={currentQuestionIndex + 1} total={totalQuestions} />
                            
                            <QuestionCard 
                                key={currentQuestion.id} 
                                question={currentQuestion} 
                                onAnswerSubmit={handleAnswerSubmit} 
                                showFeedback={showFeedback}
                                userAnswer={answers[currentQuestion.id]?.userAnswer || null}
                            />

                            <QuestionNavigation 
                                questions={activeQuestions}
                                answers={answers}
                                currentIndex={currentQuestionIndex}
                                onSelectQuestion={jumpToQuestion}
                            />

                            {/* Navigation Buttons */}
                            {showFeedback && (
                                <div className="fixed bottom-0 left-0 w-full p-4 bg-white border-t border-gray-200 md:relative md:bg-transparent md:border-0 md:p-0 md:mt-6 z-30 flex justify-center animate-slide-up shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)] md:shadow-none">
                                    <button
                                        onClick={handleNextQuestion}
                                        className="w-full md:w-auto bg-slate-900 hover:bg-slate-800 text-white text-lg font-bold py-3 px-12 rounded-xl shadow-xl transition-transform active:scale-95 flex items-center justify-center"
                                    >
                                        <span>
                                            {currentQuestionIndex === totalQuestions - 1 && answeredCount === totalQuestions 
                                                ? "Finish Exam" 
                                                : "Next Question"}
                                        </span>
                                        <svg className="w-5 h-5 ml-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M14 5l7 7m0 0l-7 7m7-7H3" />
                                        </svg>
                                    </button>
                                </div>
                            )}
                        </div>
                    )}

                    {gameState === GameState.FINISHED && (
                        <ResultScreen 
                            playerName={playerName}
                            score={correctCount} 
                            points={currentPoints}
                            total={totalQuestions} 
                            results={activeQuestions.map(q => answers[q.id] || {
                                questionId: q.id,
                                isCorrect: false,
                                userAnswer: '',
                                correctAnswer: q.correctAnswer
                            })} 
                            onRestart={handleRestart}
                            onRetryWrong={handleRetryWrong}
                        />
                    )}

                </main>
                </div>
            );
        };

        // Render App
        const rootElement = document.getElementById('root');
        const root = ReactDOM.createRoot(rootElement);
        root.render(<App />);
    </script>
</body>
</html>
